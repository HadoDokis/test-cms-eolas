function insererLien(ed, id, typelien, title, nofollow, ancre, libelle_ancre) {    ed.execCommand("mceBeginUndoLevel");    var elm = ed.selection.getNode();    elm = ed.dom.getParent(elm, function(n) {return n.nodeName.toLowerCase()=='a'}, ed.getBody());    if (elm == null) {    	//il faut donner un nom unique    	tmp = "#mce_temp_url#" + new Date().getTime();        tinyMCEPopup.execCommand("mceInsertLink", false, tmp);        aElm = tinymce.grep(ed.dom.select("a"), function(n) {return ed.dom.getAttrib(n, 'href') == tmp;});        elm = aElm[0];    }    elm.setAttribute("typelien", typelien);    elm.setAttribute("id", id);    if (title) {        elm.setAttribute("title", title);    } else {        elm.removeAttribute("title");    }    if (nofollow) {        elm.setAttribute("rel", "nofollow");    } else {        elm.removeAttribute("rel");    }    if (ancre) {        elm.setAttribute("ancre", ancre);        if (libelle_ancre) {            elm.setAttribute("libelle_ancre", libelle_ancre);        } else {            elm.removeAttribute("libelle_ancre");        }    } else {        elm.removeAttribute("ancre");        elm.removeAttribute("libelle_ancre");    }    ed.execCommand("mceEndUndoLevel");}function insererMedia(ed, idtf, wbt_code, width, height, align, format) {    var elm = ed.selection.getNode();    if (wbt_code == 'WBT_VIDEOEXTERNE') {        if (align == '') {        	width = '100%';        	height = '400';        } else {        	width = '50%';        	height = '300';        }    }    if (!ed.dom.hasClass(elm, 'mceItemFlash') && !ed.dom.hasClass(elm, 'mceItemVideo') && !ed.dom.hasClass(elm, 'mceItemVideoExterne' ) && !ed.dom.hasClass(elm, 'mceItemMusic' )) {        var html = '<img id="__mce_tmp" src="' + SERVER_ROOT + 'tinymce/plugins/cms/img/trans.gif"';        switch (wbt_code) {            case "WBT_FLASH":                html += ' class="mceItemFlash"';                break;            case "WBT_VIDEO":                html += ' class="mceItemVideo"';                break;            case "WBT_VIDEOEXTERNE":                html += ' class="mceItemVideoExterne"';                break;            case "WBT_MUSIC":                html += ' class="mceItemMusic"';                break;        }        html += ' align="'+ align + '">';        ed.execCommand("mceInsertContent", false, html);        elm = ed.dom.get('__mce_tmp');        elm.setAttribute("id", '');    }    elm.setAttribute("width", width);    elm.setAttribute("height", height);    elm.setAttribute("id", wbt_code + '_' + idtf + '_' + align);    elm.setAttribute("align", align);    elm.setAttribute("format", format);    ed.execCommand('mceRepaint');}